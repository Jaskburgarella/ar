<html>
<head>
<script src="./aframe-min.js"></script>
<script src="./aframe-ar-nft.js"></script>

<style>
@font-face {
  font-family:Roboto-Regular;
  src: url(font/roboto/Roboto-Regular.ttf);
}

  .arjs-loader {
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .arjs-loader div {
    text-align: center;
    font-size: 24px;
    color: white;
  }
  
  
  
  
  
</style>

</head>

<body style="margin : 0px; overflow: hidden;">
<div id="body">



  <!-- minimal loader shown until image descriptors are loaded -->
  <div class="arjs-loader">
    <div>Vediamo se spunta il fungo magico...</div>
  </div>
  
<script> 
var h,visibilita;
visibilita=3; // stato iniziale
var p;

  AFRAME.registerComponent('vis', {
  schema: {type: 'string'},

  init: function () {
  

  
  },
  
  valutazione: function(){
  
    
     p=new Promise((resolve,reject)=>{
	
    //var stringToLog = this.data;
    //console.log(this.el);
	 var ext=(Date.now()%2);
	 //alert(ext);
	 if (ext==1){
	 //alert(ext);
	 visibilita=1;
	 this.el.setAttribute('visible',true); 
     resolve(1);
	 
              }else
			  {
          
          
            
    			visibilita=0;			 
			  this.el.setAttribute('visible',false); 
			  resolve(1);
	 
			  }
  
  
            });

  
  } // fine funzione valutazione
  
  
  
});





/*


 AFRAME.registerComponent('vs', {
  schema: {type: 'string'},

  init: function () {
    //var stringToLog = this.data;
	},
  
  abortscena: function(){
  //this.el.setAttribute('visible',false);
  //alert('dentro abort');
 // h=this.el;
 // console.log(this.el);
 
//  document.getElementById('arjs-video').parentNode.removeChild(document.getElementById('arjs-video'))
document.body.innerHTML +=""+
"<div id=\"pannello\" style=\"position:absolute; top:100;left:1;width:300px;height:500px;background-color:white;color:black;z-index:1;\">"+
"<div>ciao</div></div>";

//  alert('hai vinto clicca per iscriverti')

  //this.el.sceneEl.parentNode.removeChild(this.el.sceneEl); 

 }
  
  
  
});
*/

  
</script>  
 
 

 
 
   <a-scene
	vr-mode-ui="enabled: false;"
    renderer="logarithmicDepthBuffer: true;"
    embedded
    arjs="trackingMethod: best; sourceType: webcam;debugUIEnabled: false;"
  >
    <!-- we use cors proxy to avoid cross-origin problems -->
    <a-nft
      type="nft"
      url="https://jaskburgarella.github.io/ar/logoparrucchiere"
	  smooth="true"
      smoothCount="10"
      smoothTolerance=".01"
      smoothThreshold="5"
    >
	  
	  
	  <a-entity
	    vis=""
		visible="false"
		gltf-model="https://jaskburgarella.github.io/ar/mushrooms.gltf"
        scale="12 12 12"
	    position="50 10 -40"
	    rotation="270 -270 -90"
      >
      </a-entity>
   

   </a-nft>
   
 
     <a-box material="color: yellow"
        gps-entity-place="latitude: 38.0168; longitude: 12.54789"
		position="0 30 0"
      />
     	  
   
   
   <a-entity gps-camera simulateLatitude="38.0168" simulateLangitude="12.54789" rotation-reader></a-entity> 
  </a-scene> 
  

  
<script>  
 /* setTimeout(function(){
document.querySelector('[vis]').components.vis.prova(); // valida anche la seconda dichiarazione 

// #2 // var header=document.querySelector('[log]').components.log;
	  //  header.prova();
  },4000);
*/


/*

// calcolare indirizzo ip.
var rispostaottenuta;
               $.ajax({
                async: true,
                type : "POST", // type of action POST || GET
                contentType: 'text/plain',                            
                url: 'http://.....php', // url where to submit the request
                crossDomain: 'true',
                dataType : 'text', // data type
                data : "nome=Giacomo", // post data || get data
                success : function(resp) {  
   rispostaottenuta=resp;				
                    // you can see the result from the console
                    // tab of the developer tools
              //token=resp.token;
                console.log("risposta: "+resp);
   				respg=resp;	// variabile globale cosi mi porto resp fuori che non so che tipo è e fuori da questa funzione la perderò(mi servirà per estrarre dati da json).	
              //  json = JSON.stringify(resp);
                },
                error: function(resp){
                     alert("json not found"); 
                 }});

*/

function generamodulo()
{

if (visibilita==1){
window.removeEventListener('click',generamodulo,false);
      
	  var iw=window.innerWidth;
	  var ih=window.innerHeight;
	  var t=ih-100;

	 document.body.innerHTML +=""+
    "<div id=\"pannello\" style=\"position:absolute; top:"+t+"px;left:1px;font-family:Roboto-Regular;font-size:14px;width:300px;height:80px;background-color:#5f69f0;border:1px solid yellow; border-radius:5px;color:white;z-index:1;\">"+
    "<center><div>Complimenti!!!!  registra adesso il tuo sconto</div>"+
	"<table><tr><td><div>Inserisci il tuo codice fiscale:</div>"+
	"</td><td><div><input type=\"text\" value=\"\" style=\"width:150px;\"></input></div></td></tr></table>"+
	 "</center></div>";


}



}









document.querySelector('[vis]').components.vis.valutazione(); // valida anche la seconda dichiarazione 
 
/*  setTimeout(function(){
document.querySelector('[vs]').components.vs.abortscena(); // valida anche la seconda dichiarazione 
  },7000);
*/

/*var sceneEl = document.querySelector('a-scene');
var btn =document.createElement("button");
btn.innerHTML = "Hello Button";
//document.body.appendChild(btn);
// Do `.setAttribute()`s to initialize the entity.
sceneEl.appendChild(btn);
*/

  // setTimeout(function(){alert('c1');},1000);
  //setTimeout(function(){alert('oggettovisibile')},20000);

 /* document.body.innerHTML +=""+
  
"<a-scene vr-mode-ui=\"enabled: false;\" renderer=\"logarithmicDepthBuffer: true;\" "+
"embedded arjs=\"trackingMethod: best; sourceType: webcam;debugUIEnabled: false;\">"+
   
"   <a-nft type=\"nft\" url=\"https://jaskburgarella.github.io/ar/skate\" smooth=\"true\" smoothCount=\"10\" smoothTolerance=\".01\" smoothThreshold=\"5\" >"+
"   <a-entity log=\"estrai\" visible=\"\" gltf-model=\"https://jaskburgarella.github.io/ar/scene.gltf\" scale=\"3 3 3\" "+
	"    position=\"80 20 -40\" "+
	"    rotation=\"270 -270 -90\">"+
"  </a-entity></a-nft><a-entity camera></a-entity></a-scene>";  
*/  





p.then((success)=>{
//alert(visibilita);
if (visibilita==0){
 setTimeout(function(){alert('Mi dispiace, Ritenta un altra volta');},20000);
}










  
  
window.addEventListener('touchend',generamodulo,false); 
window.addEventListener('click',generamodulo,false);   
  
 }); 
  


  </script>
  
</div>  
</body>
</html>